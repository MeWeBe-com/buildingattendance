<app-header [title]="'Select Location'" [selected]="selectedProperty ? selectedProperty?.status : null"
  [showMenu]="true"></app-header>

<ion-content [ngClass]="{
'green': selectedProperty?.status == '0',
'orange': selectedProperty?.status === '1',
'red': selectedProperty?.status === '2'
}" class="ion-padding">

  <div>
    <ng-select (change)="changeLocation($event)" placeholder="Start typing to search...">
      @for (p of properties; track p?.property_id) {
      <ng-option [value]="p">
        <span class="select-status" [ngClass]="{
          'green': p?.status == '0',
          'orange': p?.status === '1',
          'red': p?.status === '2'
        }"></span>
        {{p?.property_name}}
      </ng-option>
      }
    </ng-select>
  </div>

  @if(selectedProperty){
  <div class="ion-text-center lock-icon">
    <ion-icon [name]="selectedProperty?.status == '0' ? 'lock-open-outline' :
            (selectedProperty?.status === '1' ? 'warning-outline' :
            (selectedProperty?.status === '2' ? 'lock-closed-outline' : ''))"></ion-icon>
  </div>
  }


  @if(selectedProperty && selectedProperty.status == '0' && !selectedProperty?.show_toggle){
  <div class="ion-text-center arrow-icon" (click)="checkIn()">
    <div class="arrow-bg d-flex align-items-center justify-content-center" [ngClass]="{
      'arrow-green': selectedProperty?.status == '0',
      'arrow-red': selectedProperty?.status === '1',
      'arrow-orange': selectedProperty?.status === '2'
    }">
      <ion-icon name="arrow-forward-circle-outline"></ion-icon>
    </div>

    <div class="text inter-font">
      All systems operational.
    </div>
  </div>
  } @else if(selectedProperty && selectedProperty.status == '0' && selectedProperty?.show_toggle){
  <div class="ion-text-center">
    <div class="d-flex align-items-center justify-content-evenly ion-margin-vertical ion-padding toggle inter-font">
      <div>
        Check Out
      </div>
      <div>
        <ion-toggle mode="ios" [(ngModel)]="user.is_checked_in" (ionChange)="onChange($event)"
          [ngStyle]="{'--track-background-checked': user?.company_id == '1' ? 'var(--theme-green)' : 'var(--theme-darkblue)' }"></ion-toggle>
      </div>
      <div class="enable">
        Check In
      </div>
    </div>
  </div>
  }
  @else if(selectedProperty == undefined && user?.show_company_branding){
  <div class="logo-box">
    <img [src]="user?.company_logo">
  </div>
  }


  <ion-alert [isOpen]="isAlertOpen" [header]="alertHeader" [message]="alertMessage" [buttons]="alertButtons"
    (didDismiss)="isAlertOpen = false"></ion-alert>


</ion-content>